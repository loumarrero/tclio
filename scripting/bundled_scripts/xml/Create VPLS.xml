<!-- This file is generated by system. Do not edit this file. -->
<script name="Create VPLS">
  <comments>Factory script to Create and provision new VPLS</comments>
  <content>#@MetaDataStart
####################################################################
#########################
#@DetailDescriptionStart
####################################################################
#########
# Extreme Networks(R) CLI Scripting Library
# Note:  This script is an example and has undergone limited testing.  Please modify and test for your own environment.
# scripting.Script        : VPLS Creation
# Revision      : 1.1
# Last Updated  : June 25, 2015
#
# Purpose:  Create and configure a VPLS
#
#
#1.  Create a VPLS
####################################################################
#
#@DetailDescriptionEnd

# @ScriptDescription "Basic best practice deployment of Extreme switches. Please see scripting.Script View tab for details."
# @SectionStart ( description = "VPLS Basics")
# @VariableFieldLabel ( description = "Abort on error?",
#    type          = String,
#   scope       = global,
#   required    = yes,
#   validValues=[yes,no])
set var abort_when_error yes

####################################################################
############
# VPLS Definition
####################################################################
############
# @VariableFieldLabel (description   = "VPN Id", type = String,
#          scope         = global
#    )
set var vpnid ""

# @VariableFieldLabel (description = "VPLS Name",
#      type        = String,
#     scope       = global,
#      required    = yes
#    )
set var vplsname ExtremeVpls1

# @VariableFieldLabel (description = "Service Type"
#      type        = String
#     scope       = device
#    validValues = [VLAN,VMAN]
#    )
set var servicetype  VLAN

# @VariableFieldLabel (description = "Service Name"
#     type        = String
#     scope       = device
#    )
set var servicename ""

# @SectionEnd

# @SectionStart (description = "Additional parameters (optional)")

####################################################################
############
# Additional Parameters
####################################################################
############

# @VariableFieldLabel (description = "dot1q ethertype"
#      type        = String
#      scope       = device
#    )

set var dot1qethertype ""

# @VariableFieldLabel (description = "dot1q Tag Options"
#      type        = String
#      validValues = [include,exclude],
#      scope       = device
#    )

set var dot1qtag ""


# @VariableFieldLabel (description = "MTU"
#      type        = String
#      scope       = device
#    )

set var mtu ""

# @VariableFieldLabel (description = "Aging time"
#      type        = String
#      scope       = device
#    )

set var agingtime ""



# @SectionEnd
####################################################################
#########################
#@MetaDataEnd
####################################################################
############
# CONFIGURATION DETAIL
####################################################################
############
####################################################################
############
# CLI MODE
####################################################################
############
IF ($abort_when_error == no) THEN
 configure cli mode scripting ignore-error
ELSE
  configure cli mode scripting abort-on-error
ENDIF

IF (![string equal $vendor "Extreme"]) THEN
   error "This script is only supported for Extreme switches."
ENDIF

####################################################################
############
# VPLS Creation Parameters
####################################################################
############
if {[catch {

  IF ([expr [string length $vplsname] > 0]) THEN
    IF ([expr [string length $vpnid] > 0]) THEN
       create vpls  $vplsname fec-id-type pseudo-wire $vpnid
    ENDIF
    IF ([expr [string length $servicetype] > 0]) THEN
      IF ([expr [string length $servicename] > 0]) THEN
        IF ([string equal $servicetype VLAN]) THEN
          configure vpls $vplsname add service vlan $servicename
        ENDIF
        IF ([string equal $servicetype VMAN]) THEN
          configure vpls $vplsname add service vman $servicename
        ENDIF
     ENDIF
    ENDIF

    #Setting up optional parameters
    IF ([expr [string length $dot1qethertype] > 0]) THEN
       configure vpls $vplsname dot1q ethertype $dot1qethertype
    ENDIF
    IF ([expr [string length $dot1qtag] > 0]) THEN
       configure vpls $vplsname dot1q  tag $dot1qtag
    ENDIF
    IF ([expr [string length $mtu] > 0]) THEN
        configure vpls $vplsname mtu $mtu
    ENDIF
    IF ([expr [string length $agingtime] > 0]) THEN
       configure fdb agingtime $agingtime
    ENDIF

  ENDIF
  PerformSync -scope VPLS
} result ]} {
     error "Error occurred during vpls configuration. $result"
   }
 </content>
  <contexts>,VPLS Services,Device,</contexts>
  <supprotedGroups></supprotedGroups>
  <roles>,Administrator,Manager,</roles>
  <auditLogEnabled>false</auditLogEnabled>
  <saveConfigOnExit>false</saveConfigOnExit>
  <menuScope>TOOLS</menuScope>
  <scriptTimeout>60</scriptTimeout>
  <defaultCategory>VPLS</defaultCategory>
   <creator>system</creator>
</script>