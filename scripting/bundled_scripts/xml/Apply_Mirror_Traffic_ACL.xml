<!-- This file is generated by system. Do not edit this file. -->
<script name="Apply_Mirror_Traffic_ACL">
<comments>Factory script to apply access-lists to mirror both incoming and outgoing traffic of a host</comments>
<content>#@MetaDataStart
####################################################################
#@DetailDescriptionStart
#############################################################################
# Extreme Networks(R) CLI Scripting Library
# scripting.Script        : Apply access-lists to mirror both incoming and outgoing traffic of a host
# Revision      : 1.1
# Last Updated  : April 25, 2011
#
# Purpose:  To apply access-lists to mirror both incoming and outgoing traffic of a host
#
#
#
#####################################################################
#@DetailDescriptionEnd

# @ScriptDescription "Basic best practice deployment of Extreme switches. Please see scripting.Script View tab for details."
# @SectionStart ( description = "Mirror Traffic ACL Basics")
# @VariableFieldLabel ( description = "Abort on error?",
#    type          = String,
#   scope       = global,
#   required    = yes,
#   validValues=[yes,no])
set var abort_when_error yes

################################################################################
# Mirror traffic
################################################################################
# @VariableFieldLabel (description = "MAC address of the host"
#      type        = String
#     scope       = global
#      required    = yes
#    )
set var hostMacAddress &quot;&quot;

# @VariableFieldLabel (description = "Port number of the switch"
#      type        = String
#     scope       = global
#      required    = yes
#    )
set var hostSwitchPort &quot;&quot;

# @SectionEnd

#@MetaDataEnd
################################################################################
################################################################################
# CONFIGURATION DETAIL
################################################################################
################################################################################
# CLI MODE
################################################################################
IF ($abort_when_error == no) THEN
 configure cli mode scripting ignore-error
ELSE
  configure cli mode scripting abort-on-error
ENDIF

IF (![string equal $vendor &quot;Extreme&quot;]) THEN
   error &quot;This script is only supported for Extreme switches.&quot;
ENDIF


################################################################################
# Mirror traffic script Parameters
################################################################################

IF ([string equal $hostMacAddress ""]) then
    error &quot;hostMacAddress parameter cannot be empty&quot;
ENDIF

IF ([string equal $hostSwitchPort ""]) then
    error &quot;hostSwitchPort parameter cannot be empty&quot;
ENDIF

append aclName $hostMacAddress "_"
append aclName $hostSwitchPort

if {[catch {
    create access-list MirrorS_$aclName "ethernet-source-address $hostMacAddress" "mirror"
} result ]} {
    error "Error occurred during access-list configuration. $result"
}

if {[catch {
    configure access-list add MirrorS_$aclName first ports $hostSwitchPort
} result ]} {
    delete access-list MirrorS_$aclName
    error "Error occurred during access-list configuration. $result"
}

if {[catch {
    create access-list MirrorD_$aclName "ethernet-destination-address $hostMacAddress" "mirror"
} result ]} {
    configure access-list delete MirrorS_$aclName ports $hostSwitchPort
    delete access-list MirrorS_$aclName
    error "Error occurred during access-list configuration. $result"
}

if {[catch {
    configure access-list add MirrorD_$aclName after MirrorS_$aclName ports $hostSwitchPort
} result ]} {
    configure access-list delete MirrorS_$aclName ports $hostSwitchPort
    delete access-list MirrorS_$aclName
    delete access-list MirrorD_$aclName
    error "Error occurred during access-list configuration. $result"
}
</content>
  <creator>system</creator>
  <contexts>,Device,</contexts>
  <supprotedGroups></supprotedGroups>
  <roles>,Administrator,</roles>
  <auditLogEnabled>true</auditLogEnabled>
  <saveConfigOnExit>false</saveConfigOnExit>
  <menuScope>TOOLS</menuScope>
  <scriptTimeout>60</scriptTimeout>
  <defaultCategory>Security</defaultCategory>
</script>
